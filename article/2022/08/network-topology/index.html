<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>我的网络环境 - arjenzhou</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="背景 故事发生在今年的2月。PS5到手没两天诞生了搞直播的想法，在摸索的过程中发现了《搭建 PS4 本地直播服务器》这篇帖子，于是就冒出了折腾的心思。毕竟花钱买采集卡有点冤大头的感觉。
之前家里的网络环境比较简单，只需要在 Openwrt 上装一些插件，所以一台在上学时候收的一个矿渣 K2P 就够了。
矿渣 K2P 后来因为 UU 的插件不够稳定，又搞了一个 UU 加速盒。 垃圾 UU 加速盒 但是如果想搞直播，就得每天在工作电脑上跑一个 docker，太麻烦了。
于是，我便斥巨资购入了一款 J4125 J4125 遗憾的是，尽管这款主机内置了 MSATA 和 SATA3.0 两款接口，但是没有能力容纳下一个 SATA3.0 的硬盘，所以在我手里变成了这样： 外挂式硬盘，蚌埠住了 软路由 过了半年回过头来看，其实根本没必要来搞一个性能远远溢出的 J4125，因为实际上只会跑几个性能开销很小的虚拟机。
搞这台小主机的目的是为了装一个 debian 来跑 nginx 拦截 PS5 的流量，而裸装 debian 有点不够划算，于是干脆个装 PVE 来个 all in one。 All in PVE 第一步，先把 ROS 和作为 AC 的 Openwrt 搞好，参考《基于PVE+ROS+LEDE的软路由配置流程》，其中需要注意的是，Openwrt 的安装比较麻烦，需要后挂载。在设备联入网络时，根据网关设置为 ROS 或者 Openwrt，可以区分不同的网络环境实现按需科学上网。
AP 按照上面引用的文章操作完成后，网络设备可以通过插网线的模式来上网了。但是现在都什么年代了还在用传统上网？所以把 K2P 设置成 AP，参考《OpenWRT 设置桥接交换机模式（AP模式）》，注意设置为交换机模式后就可以当 AP 使用，如果想通过无线连接到 AP 上需要设置客户端。"><meta property="og:image" content><meta property="og:title" content="我的网络环境"><meta property="og:description" content="背景 故事发生在今年的2月。PS5到手没两天诞生了搞直播的想法，在摸索的过程中发现了《搭建 PS4 本地直播服务器》这篇帖子，于是就冒出了折腾的心思。毕竟花钱买采集卡有点冤大头的感觉。
之前家里的网络环境比较简单，只需要在 Openwrt 上装一些插件，所以一台在上学时候收的一个矿渣 K2P 就够了。
矿渣 K2P 后来因为 UU 的插件不够稳定，又搞了一个 UU 加速盒。 垃圾 UU 加速盒 但是如果想搞直播，就得每天在工作电脑上跑一个 docker，太麻烦了。
于是，我便斥巨资购入了一款 J4125 J4125 遗憾的是，尽管这款主机内置了 MSATA 和 SATA3.0 两款接口，但是没有能力容纳下一个 SATA3.0 的硬盘，所以在我手里变成了这样： 外挂式硬盘，蚌埠住了 软路由 过了半年回过头来看，其实根本没必要来搞一个性能远远溢出的 J4125，因为实际上只会跑几个性能开销很小的虚拟机。
搞这台小主机的目的是为了装一个 debian 来跑 nginx 拦截 PS5 的流量，而裸装 debian 有点不够划算，于是干脆个装 PVE 来个 all in one。 All in PVE 第一步，先把 ROS 和作为 AC 的 Openwrt 搞好，参考《基于PVE+ROS+LEDE的软路由配置流程》，其中需要注意的是，Openwrt 的安装比较麻烦，需要后挂载。在设备联入网络时，根据网关设置为 ROS 或者 Openwrt，可以区分不同的网络环境实现按需科学上网。
AP 按照上面引用的文章操作完成后，网络设备可以通过插网线的模式来上网了。但是现在都什么年代了还在用传统上网？所以把 K2P 设置成 AP，参考《OpenWRT 设置桥接交换机模式（AP模式）》，注意设置为交换机模式后就可以当 AP 使用，如果想通过无线连接到 AP 上需要设置客户端。"><meta property="og:type" content="article"><meta property="og:url" content="/article/2022/08/network-topology/"><meta property="article:section" content="article"><meta property="article:published_time" content="2022-08-30T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-30T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="我的网络环境"><meta name=twitter:description content="背景 故事发生在今年的2月。PS5到手没两天诞生了搞直播的想法，在摸索的过程中发现了《搭建 PS4 本地直播服务器》这篇帖子，于是就冒出了折腾的心思。毕竟花钱买采集卡有点冤大头的感觉。
之前家里的网络环境比较简单，只需要在 Openwrt 上装一些插件，所以一台在上学时候收的一个矿渣 K2P 就够了。
矿渣 K2P 后来因为 UU 的插件不够稳定，又搞了一个 UU 加速盒。 垃圾 UU 加速盒 但是如果想搞直播，就得每天在工作电脑上跑一个 docker，太麻烦了。
于是，我便斥巨资购入了一款 J4125 J4125 遗憾的是，尽管这款主机内置了 MSATA 和 SATA3.0 两款接口，但是没有能力容纳下一个 SATA3.0 的硬盘，所以在我手里变成了这样： 外挂式硬盘，蚌埠住了 软路由 过了半年回过头来看，其实根本没必要来搞一个性能远远溢出的 J4125，因为实际上只会跑几个性能开销很小的虚拟机。
搞这台小主机的目的是为了装一个 debian 来跑 nginx 拦截 PS5 的流量，而裸装 debian 有点不够划算，于是干脆个装 PVE 来个 all in one。 All in PVE 第一步，先把 ROS 和作为 AC 的 Openwrt 搞好，参考《基于PVE+ROS+LEDE的软路由配置流程》，其中需要注意的是，Openwrt 的安装比较麻烦，需要后挂载。在设备联入网络时，根据网关设置为 ROS 或者 Openwrt，可以区分不同的网络环境实现按需科学上网。
AP 按照上面引用的文章操作完成后，网络设备可以通过插网线的模式来上网了。但是现在都什么年代了还在用传统上网？所以把 K2P 设置成 AP，参考《OpenWRT 设置桥接交换机模式（AP模式）》，注意设置为交换机模式后就可以当 AP 使用，如果想通过无线连接到 AP 上需要设置客户端。"><link href=/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=/css/main.39ebaad9fc9f12a7ee415682ebf69793198eb40de807ad546a08fe9ad5e51438.css><link id=darkModeStyle rel=stylesheet type=text/css href=/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css media="(prefers-color-scheme: dark)"><link rel=stylesheet href=/katex/katex.min.css><script defer src=/katex/katex.min.js></script>
<script defer src=/katex/contrib/auto-render.js onload=renderMathInElement(document.body)></script>
<script src=https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js></script></head><body><div class=content><header><div class=main><a href=/>arjenzhou</a></div><nav><a href=/article>Article</a>
<a href=/translation>Translation</a>
<a href=/reproduction>Reproduction</a>
<a href=/categories>Category</a>
<a href=/feed.xml>Subscribe</a></nav></header><main><article><div class=title><h1 class=title>我的网络环境</h1><span class=link></span><div class=meta>Posted on Aug 30, 2022</span><hr></div></div><section class=body><h1 id=背景>背景</h1><p>故事发生在今年的2月。PS5到手没两天诞生了搞直播的想法，在摸索的过程中发现了《<a href=https://homulilly.com/post/play-ps4-live-stream-at-local.html>搭建 PS4 本地直播服务器</a>》这篇帖子，于是就冒出了折腾的心思。毕竟花钱买采集卡有点冤大头的感觉。</p><p>之前家里的网络环境比较简单，只需要在 Openwrt 上装一些插件，所以一台在上学时候收的一个矿渣 K2P 就够了。</p><figure><img src=https://s2.loli.net/2022/08/30/7dJkU4iIrhueqpW.png><figcaption><h4>矿渣 K2P</h4></figcaption></figure><p>后来因为 UU 的插件不够稳定，又搞了一个 UU 加速盒。<figure><img src=https://s2.loli.net/2022/08/30/XnFu6aRpCyS5Uvk.jpg><figcaption><h4>垃圾 UU 加速盒</h4></figcaption></figure></p><p>但是如果想搞直播，就得每天在工作电脑上跑一个 docker，太麻烦了。</p><p>于是，我便斥巨资购入了一款 J4125<figure><img src=https://s2.loli.net/2022/08/30/u3Ca5fFdVrGUO78.jpg><figcaption><h4>J4125</h4></figcaption></figure></p><p>遗憾的是，尽管这款主机内置了 MSATA 和 SATA3.0 两款接口，但是没有能力容纳下一个 SATA3.0 的硬盘，所以在我手里变成了这样：<figure><img src=https://s2.loli.net/2022/08/30/ekSHDZqGURTJFwY.jpg><figcaption><h4>外挂式硬盘，蚌埠住了</h4></figcaption></figure></p><h1 id=软路由>软路由</h1><blockquote><p>过了半年回过头来看，其实根本没必要来搞一个性能远远溢出的 J4125，因为实际上只会跑几个性能开销很小的虚拟机。</p></blockquote><p>搞这台小主机的目的是为了装一个 debian 来跑 nginx 拦截 PS5 的流量，而裸装 debian 有点不够划算，于是干脆个装 PVE 来个 all in one。<figure><img src=https://s2.loli.net/2022/08/30/8IH6F3QqbtMxs49.png><figcaption><h4>All in PVE</h4></figcaption></figure></p><p>第一步，先把 ROS 和作为 AC 的 Openwrt 搞好，参考《<a href=https://www.cnblogs.com/Pyrokine/p/14526662.html>基于PVE+ROS+LEDE的软路由配置流程</a>》，其中需要注意的是，Openwrt 的安装比较麻烦，需要后挂载。在设备联入网络时，根据网关设置为 ROS 或者 Openwrt，可以区分不同的网络环境实现按需科学上网。</p><h1 id=ap>AP</h1><p>按照上面引用的文章操作完成后，网络设备可以通过插网线的模式来上网了。但是现在都什么年代了还在用传统上网？所以把 K2P 设置成 AP，参考《<a href=https://www.wyr.me/post/676>OpenWRT 设置桥接交换机模式（AP模式）</a>》，注意设置为交换机模式后就可以当 AP 使用，如果想通过无线连接到 AP 上需要设置客户端。</p><h1 id=pppoe>PPPoE</h1><p>4月9号的时候，由于工作调动搬了一次家，新的房子由于线路比较老，不能接入光纤，只能 PPPoE 拨号上网。所以需要对 ROS 做一些简单的调整，参考《<a href=https://zhuanlan.zhihu.com/p/194360234>RouterOS(ROS)软路由PPPOE拨号上网配置指南(附授权镜像下载)</a>》</p><h2 id=debian>Debian</h2><p>前置工作就绪了，关键在于 Nginx 的搭建。先搞一个 Debian 起来用来跑 Nginx，参加开头的文章。目前的网络拓扑如下图</p><figure><img src=https://s2.loli.net/2022/08/30/vJnMBT41m5gbU6x.png><figcaption><h4>网络拓扑</h4></figcaption></figure><p>过了一段时间我发现了一个更方便的方案，参考《<a href=https://www.chiphell.com/thread-2399569-1-1.html>折腾PS5直接在B站直播</a>》。搞成了之后，不但能直播还能看弹幕了。<figure><img src=https://s2.loli.net/2022/08/30/VOTufek5iItRzxL.png><figcaption><h4>推流成功后会有一条记录的，懒得弄了</h4></figcaption></figure></p><h2 id=后记>后记</h2><p>本来想写一篇比较详细的文章来介绍一下来着，但是由于时间太久了，当初折腾的细节都忘得差不多了。不过参考本文引用到的文章，自己再多折腾一下问题应该也不大。到现在为止最坑爹的问题就是我把 ROS 的登录密码忘掉了……不过善用 PVE 里面的 snapshot 很方便回滚。
（其实今天我想起来写这篇文章，是因为打算在主机里面再装一个 Windows 玩云顶之弈）<a href=https://www.gordon2000.com/2021/10/pvewindows-11-step-by-step.html>PVE安装Windows 11虚拟机 step by step</a></p><p>打个广告：<a href=http://live.bilibili.com/21205154>大连一方勇夺世界杯的直播间</a></p></section><div class=post-tags></div></article><h1>Comments:</h1><div id=cusdis_thread data-host=https://cusdis.com data-app-id=71c1c07d-0104-4d23-9cbc-827c46070d54 data-page-id=28cd5fbf5ac087cc6b0a354051a991ca data-page-url=/article/2022/08/network-topology/ data-page-title=我的网络环境></div><script async defer src=https://cusdis.com/js/cusdis.es.js></script></main><footer><hr>⚡️
2022 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></footer></div></body></html>